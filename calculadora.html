<div class='form'>
  <p class='label'>Qual o seu sexo?<p/>
  <input type='radio' name='gender' value='F' checked> Feminino
  <input type='radio' name='gender' value='M'> Masculino<br>
  <p class='label'>Qual a sua idade?</p>
  <input type='number' id='age' min='16' max='120'><br>
  <p class='label'>Por quanto tempo trabalhou com carteira assinada?</p>
  <input type='number' id='contribution' min='0' max='104'><br>
  <p class='label'>Em qual setor trabalha?<p/>
  <input type='radio' name='sector' value='PRIVATE' checked> Privado
  <input type='radio' name='sector' value='PUBLIC'> Público<br>
  <input type='button' value='Calcule' onclick='initialize_calculation()'>
</div>

<div class='results'>
  <p  id='new_value'></p>
  <p  id='old_value'></p>
</div>

<script>
function initialize_calculation(){
  var gender_input = document.querySelector('input[name=\"gender\"]:checked').value;
  var age_input = document.getElementById('age').value;
  var contribution_input = document.getElementById('contribution').value;
  var sector_input = document.querySelector('input[name=\"sector\"]:checked').value;
  var result_old = calculadoraOld(gender_input, age_input, contribution_input, sector_input);
  var result_new = calculadoraNew(gender_input, age_input, contribution_input, sector_input);
  message('new_value', result_new);
  message('old_value', result_old);
}

function newRules(gender, age) {

 if((gender == 'F') && (age <=45) || (gender == 'M') && (age <=50)){
   return 'new';
 }
 else {
   return 'old';
 }
}

function oldRules(service, gender) {
  if(service == 'PUBLIC'){
    if (gender == 'F') {
      return 'public_woman';
    }
    else if (gender == 'M') {
      return 'public_man';
    }
  }
  else{
    if (gender == 'F') {
      return 'private_woman';
    }
    else if (gender == 'M') {
      return 'private_man';
    }
  }
}

function calculateNewRules(age, contribution) {
  var age_time = 65 - age;
  var contribution_time = 25 - contribution;
  var time_left = Math.max(age_time, contribution_time);
  return time_left;
};

function calculatePublicOldRulesWoman(age, contribution) {
  var age_time = 55 - age;
  var contribution_time = 30 - contribution;
  var time_left = Math.max(age_time, contribution_time);
  return time_left;
};

function calculatePublicOldRulesMan(age, contribution) {
  var age_time = 60 - age;
  var contribution_time = 35 - contribution;
  var time_left = Math.max(age_time, contribution_time);
  return time_left;
};

function calculatePrivateOldRulesWoman(age, contribution) {
  var age_time = 60 - age;
  var age_contribution_time = 15 - contribution;
  var contribution_time = 30 - contribution;
  var age_time_left = Math.max(age_time, age_contribution_time);
  var time_left = Math.min(age_time_left, contribution_time);
  return time_left;
};

function calculatePrivateOldRulesMan(age, contribution) {
  var age_time = 65 - age;
  var age_contribution_time = 15 - contribution;
  var contribution_time = 35 - contribution;
  var age_time_left = Math.max(age_time, age_contribution_time);
  var time_left = Math.min(age_time_left, contribution_time);
  return time_left;
};

function calculadoraNew(gender, age, contribution, service) {
 var rules = newRules(gender, age);

 if (rules == 'new') {
   var result_new = calculateNewRules(age, contribution);
 }
 else {
   var partial = calculadoraOld(gender, age, contribution, service);
   var result_new = (1.5 * Math.abs(age - partial));
 }

 result_new = Number(result_new) + Number(age);
 return Math.round(result_new);

};

function calculadoraOld(gender, age, contribution, service) {
 var rules = oldRules(service, gender);

 if (rules == 'public_woman') {
   var result_old = calculatePublicOldRulesWoman(age, contribution);
 }
 else if (rules == 'public_man') {
   var result_old = calculatePublicOldRulesMan(age, contribution);
 }
 else if (rules == 'private_woman') {
   var result_old = calculatePrivateOldRulesWoman(age, contribution);
 }
 else if (rules == 'private_man') {
   var result_old = calculatePrivateOldRulesMan(age, contribution);
 }
 result_old = Number(result_old) + Number(age);
 return Math.round(result_old);
};

function message(element, text){
  if (element == "new_value") {
  document.getElementById(element).innerHTML = "<p>Se a reforma for aprovada, voce</p>" + "<p id='newrulevalue'>" + text + "</p>" + "<p>anos</p>";
} else {
  document.getElementById(element).innerHTML = "<p>Pelas legislação atual:</p>" + "<p id='oldrulevalue'>" + text  + "</p>" + "<p>anos</p>";
}

};

</script>
